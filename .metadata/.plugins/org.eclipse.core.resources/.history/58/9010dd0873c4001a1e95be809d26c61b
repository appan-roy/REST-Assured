package utility;

import java.io.IOException;

import org.apache.poi.ss.usermodel.DataFormatter;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class Excel_Utils {

	static String projDir = System.getProperty("user.dir");
	
	static String excelPath = projDir+"/test data/Data.xlsx";
	
	static String sheetName = "Grandmasters";
	
	static XSSFWorkbook wrkbk;
	
	static XSSFSheet sht;
	
	public Excel_Utils(String excelPath, String sheetName) throws Exception {
		
		XSSFWorkbook wrkbk = new XSSFWorkbook(excelPath);
		
		XSSFSheet sht = wrkbk.getSheet(sheetName);
		
	}
	
	public static void getRowCount() throws Exception {

		XSSFWorkbook wrkbk = new XSSFWorkbook(excelPath);
		
		XSSFSheet sht = wrkbk.getSheet(sheetName);
		
		int rowCount = sht.getPhysicalNumberOfRows();
		
	}
	
	public static void getCellData() throws Exception {

		XSSFWorkbook wrkbk = new XSSFWorkbook(excelPath);
		
		XSSFSheet sht = wrkbk.getSheet(sheetName);
		
		DataFormatter formatter = new DataFormatter();
		
		Object val = formatter.formatCellValue(sht.getRow(1).getCell(0));
		
		System.out.println(val);
		
	}
	
	public static void main(String[] args) throws Exception {
		getRowCount();
		getCellData();
	}

}
